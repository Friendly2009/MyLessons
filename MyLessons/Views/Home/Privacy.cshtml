@model user;
@using MyLessons.ConverterSQLClass;
@{
	List<lesson> ClassLessons = new List<lesson>();

	if(!(ViewBag.Lessons is null))
	{
		for(int i = 0; i < ViewBag.Lessons.Count; i++)
		{
			if(ViewBag.Lessons[i].clas == ViewBag.Clas)
			{
				ClassLessons.Add(ViewBag.Lessons[i]);
			}
		}
	}	
	string[] parameters(int day,int num)
	{
		string[] el = new string[4];
		for (int i = 0; i < ClassLessons.Count(); i++)
		{
			if (ClassLessons[i].number == $"{num}" && ClassLessons[i].day == $"{day}")
			{
				el[0] = ClassLessons[i].teacher;
				el[1] = ClassLessons[i].less.Trim();
				el[2] = ClassLessons[i].number;
				el[3] = ClassLessons[i].day;
			}
		}
		return el;
	}
	void GetElementTable(int day,int num)
	{
		for(int i = 0; i < ClassLessons.Count; i++)
		{
			if (ClassLessons[i].day == $"{day}" && ClassLessons[i].number == $"{num}")
			{
				<p class="m-1">@ClassLessons[i].less</p>
				<p class="m-1">@ClassLessons[i].room</p>
				<p class="m-1">@ClassLessons[i].teacher</p>
			}
		}
	}
}
<div>
	<div class="row justify-content-center container">
		@{
			for (int i = 0; i < ViewBag.socials.Count; i++)
			{
				<form asp-action="Choose" asp-controller="Home" method="get" class="col-1 m-1">
					<input type="hidden" asp-for="login" />
					<input type="hidden" name="clas" value="@ViewBag.socials[i]" />
					<button type="submit" class="btn btn-dark w-100">@ViewBag.socials[i]</button>
				</form>
			}
		}
	</div>
	<h1 class="align-content-center">@ViewBag.Clas</h1>
	<table class="table">
		<tr>
			<td>@ViewBag.Clas</td>
			<td>Понедельник</td>
			<td>Вторник</td>
			<td>Среда</td>
			<td>Четверг</td>
			<td>Пятница</td>
			<td>Суббота</td>
		</tr>
		<tr>
			<td>1</td>
			<td day ="@parameters(1,1);">@{GetElementTable(1, 1);}</td>
			<td>@{GetElementTable(1, 2);}</td>
			<td>@{GetElementTable(1, 3);}</td>
			<td>@{GetElementTable(1, 4);}</td>
			<td>@{GetElementTable(1, 5);}</td>
			<td>@{GetElementTable(1, 6);}</td>
		</tr>
		<tr>
			<td>2</td>
			<td>@{GetElementTable(2, 1);}</td>
			<td>@{GetElementTable(2, 2);}</td>
			<td>@{GetElementTable(2, 3);}</td>
			<td>@{GetElementTable(2, 4);}</td>
			<td>@{GetElementTable(2, 5);}</td>
			<td>@{GetElementTable(2, 6);}</td>
		</tr>
		<tr>
			<td>3</td>
			<td>@{GetElementTable(3, 1);}</td>
			<td>@{GetElementTable(3, 2);}</td>
			<td>@{GetElementTable(3, 3);}</td>
			<td>@{GetElementTable(3, 4);}</td>
			<td>@{GetElementTable(3, 5);}</td>
			<td>@{GetElementTable(3, 6);}</td>
		</tr>
		<tr>
			<td>4</td>
			<td>@{GetElementTable(4, 1);}</td>
			<td>@{GetElementTable(4, 2);}</td>
			<td>@{GetElementTable(4, 3);}</td>
			<td>@{GetElementTable(4, 4);}</td>
			<td>@{GetElementTable(4, 5);}</td>
			<td>@{GetElementTable(4, 6);}</td>
		</tr>
	</table>
	<div class="row justify-content-center">
		<div class="row justify-content-center col-8">
			<input type="number" class="input-group-text col-12 m-3" placeholder="Номер кабинета" />
		</div>
		<div class="row justify-content-center col-8">
			<button class="btn btn-dark col-12 mb-2" type="button" data-bs-toggle="collapse" data-bs-target="#TeacherDiv" aria-expanded="false" aria-controls="TeacherDiv">
				Учителя
			</button>
		</div>
		<div class="collapse col-8" id="TeacherDiv">
			@for (int i = 0; i < ViewBag.teachers.Count; i++)
			{
				<div class="row align-items-center mb-2" style="margin: 10px 0;">
					<p class="col-4 mb-0">@ViewBag.teachers[i]</p>
					<p class="col-3 mb-0">@ViewBag.objects[i]</p>
					<button class="btn btn-dark col-2">Назначить урок</button>
					<form asp-action="DeleteTeacher" asp-controller="Home" method="post" class="col-3 d-flex justify-content-end mb-0">
						<input type="hidden" />
						<input type="hidden" />
						<button class="btn btn-close btn-dark"></button>
					</form>
				</div>
			}
			<form asp-action="AddTeacher" method="post" class="row justify-content-center m-2">
				<p>Добавить учителя</p>
				<select id="myComboBox" name="selectedSubject" class="form-select m-2" aria-label="Выберите значение" required>
					<option selected disabled>Выберите Предмет</option>
					@for (int i = 0; i < ViewBag.availableItems.Count; i++)
					{
						<option value="@ViewBag.availableItems[i]">@ViewBag.availableItems[i]</option>
					}
				</select>
				<input type="text" class="form-control col-3" placeholder="Имя учителя" name="teacherName" required>
				<button class="btn btn-dark col-6 m-2" type="submit">Добавить учителя</button>
			</form>
		</div>

		<div class="row justify-content-center">
			<button class="btn btn-dark col-8 m-3" id="deleteLesson">
				Удалить Урок
			</button>
		</div>
		<form asp-action="UpdateTable" asp-controller="Home" method="post" class="row justify-content-center m-1">
			<input type="hidden" name="data" value="@ViewBag.data" />
			<button class="btn btn-dark col-8">Сохранить изменения</button>
		</form>
	</div>
</div>
